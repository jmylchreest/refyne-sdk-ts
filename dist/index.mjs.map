{"version":3,"sources":["../src/interfaces.ts","../src/cache.ts","../src/errors.ts","../src/version.ts","../src/fetch.ts","../src/client.ts"],"names":[],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * Interfaces for dependency injection in the Refyne SDK.\n *\n * These interfaces allow you to inject custom implementations for logging,\n * HTTP requests, and caching. This enables easy testing and integration\n * with your application's existing infrastructure.\n *\n * @packageDocumentation\n */\n\n/**\n * Logger interface for SDK logging.\n *\n * Implement this interface to integrate with your application's logger\n * (e.g., pino, winston, console).\n *\n * @example\n * ```typescript\n * import pino from 'pino';\n *\n * const pinoLogger = pino();\n *\n * const logger: Logger = {\n *   debug: (msg, meta) => pinoLogger.debug(meta, msg),\n *   info: (msg, meta) => pinoLogger.info(meta, msg),\n *   warn: (msg, meta) => pinoLogger.warn(meta, msg),\n *   error: (msg, meta) => pinoLogger.error(meta, msg),\n * };\n * ```\n */\nexport interface Logger {\n  /** Log a debug message */\n  debug(msg: string, meta?: Record<string, unknown>): void;\n  /** Log an info message */\n  info(msg: string, meta?: Record<string, unknown>): void;\n  /** Log a warning message */\n  warn(msg: string, meta?: Record<string, unknown>): void;\n  /** Log an error message */\n  error(msg: string, meta?: Record<string, unknown>): void;\n}\n\n\n/**\n * Cache entry with value and metadata.\n */\nexport interface CacheEntry {\n  /** The cached response body */\n  value: unknown;\n  /** When the entry expires (Unix timestamp in ms) */\n  expiresAt: number;\n  /** Cache-Control directives from the response */\n  cacheControl: CacheControlDirectives;\n}\n\n/**\n * Parsed Cache-Control header directives.\n */\nexport interface CacheControlDirectives {\n  /** Maximum age in seconds */\n  maxAge?: number;\n  /** Whether to never cache */\n  noStore?: boolean;\n  /** Whether to revalidate before using */\n  noCache?: boolean;\n  /** Whether this is private (user-specific) data */\n  private?: boolean;\n  /** Stale-while-revalidate window in seconds */\n  staleWhileRevalidate?: number;\n}\n\n/**\n * Cache interface for response caching.\n *\n * The SDK includes a default in-memory cache that respects Cache-Control headers.\n * Implement this interface to use Redis, localStorage, or another cache backend.\n *\n * @example\n * ```typescript\n * // Redis cache implementation\n * import { createClient } from 'redis';\n *\n * const redis = createClient();\n *\n * const redisCache: Cache = {\n *   async get(key) {\n *     const data = await redis.get(key);\n *     return data ? JSON.parse(data) : undefined;\n *   },\n *   async set(key, entry) {\n *     const ttl = Math.max(0, entry.expiresAt - Date.now());\n *     await redis.set(key, JSON.stringify(entry), { PX: ttl });\n *   },\n *   async delete(key) {\n *     await redis.del(key);\n *   },\n * };\n * ```\n */\nexport interface Cache {\n  /**\n   * Get a cached entry by key.\n   * @param key - The cache key\n   * @returns The cached entry, or undefined if not found/expired\n   */\n  get(key: string): Promise<CacheEntry | undefined>;\n\n  /**\n   * Set a cache entry.\n   * @param key - The cache key\n   * @param entry - The entry to cache\n   */\n  set(key: string, entry: CacheEntry): Promise<void>;\n\n  /**\n   * Delete a cache entry.\n   * @param key - The cache key to delete\n   */\n  delete(key: string): Promise<void>;\n}\n\n/**\n * Default console logger implementation.\n * @internal\n */\nexport const defaultLogger: Logger = {\n  debug: (msg, meta) => {\n    // Use globalThis to avoid Deno type errors with process\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const proc = 'process' in globalThis ? (globalThis as any).process : undefined;\n    if (proc?.env?.DEBUG) {\n      console.debug(`[Refyne SDK] ${msg}`, meta || '');\n    }\n  },\n  info: (msg, meta) => console.info(`[Refyne SDK] ${msg}`, meta || ''),\n  warn: (msg, meta) => console.warn(`[Refyne SDK] ${msg}`, meta || ''),\n  error: (msg, meta) => console.error(`[Refyne SDK] ${msg}`, meta || ''),\n};\n\n","/**\n * Cache implementation that respects Cache-Control headers.\n *\n * @packageDocumentation\n */\n\nimport type { Cache, CacheEntry, CacheControlDirectives, Logger } from './interfaces';\n\n/**\n * Parse Cache-Control header into directives.\n *\n * @param header - The Cache-Control header value\n * @returns Parsed directives\n *\n * @example\n * ```typescript\n * parseCacheControl('private, max-age=3600, stale-while-revalidate=60')\n * // Returns: { private: true, maxAge: 3600, staleWhileRevalidate: 60 }\n * ```\n */\nexport function parseCacheControl(header: string | null): CacheControlDirectives {\n  if (!header) {\n    return {};\n  }\n\n  const directives: CacheControlDirectives = {};\n\n  const parts = header.toLowerCase().split(',').map((s) => s.trim());\n\n  for (const part of parts) {\n    if (part === 'no-store') {\n      directives.noStore = true;\n    } else if (part === 'no-cache') {\n      directives.noCache = true;\n    } else if (part === 'private') {\n      directives.private = true;\n    } else if (part.startsWith('max-age=')) {\n      const value = parseInt(part.substring(8), 10);\n      if (!isNaN(value)) {\n        directives.maxAge = value;\n      }\n    } else if (part.startsWith('stale-while-revalidate=')) {\n      const value = parseInt(part.substring(23), 10);\n      if (!isNaN(value)) {\n        directives.staleWhileRevalidate = value;\n      }\n    }\n  }\n\n  return directives;\n}\n\n/**\n * Generate a cache key from request details.\n *\n * @param method - HTTP method\n * @param url - Request URL\n * @param authHash - Hash of the auth token (for user-specific caching)\n * @returns Cache key string\n */\nexport function generateCacheKey(\n  method: string,\n  url: string,\n  authHash?: string\n): string {\n  const parts = [method.toUpperCase(), url];\n  if (authHash) {\n    parts.push(authHash);\n  }\n  return parts.join(':');\n}\n\n/**\n * Hash a string using SHA-256 (truncated to 16 chars for cache keys).\n * Uses Web Crypto API for secure hashing.\n *\n * Note: This is an async function. For synchronous use, call hashStringSync instead.\n *\n * @param str - The string to hash\n * @returns Promise resolving to truncated SHA-256 hash (16 chars)\n */\nexport async function hashStringAsync(str: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(str);\n\n  // Use Web Crypto API (available in browsers, Node 18+, Deno, Bun)\n  const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n\n  // Return first 16 characters (64 bits of entropy is sufficient for cache keys)\n  return hashHex.substring(0, 16);\n}\n\n/**\n * Synchronous hash function using a simple but effective algorithm.\n * This is used during client initialization before async operations are possible.\n * Uses FNV-1a for better distribution than djb2.\n *\n * @param str - The string to hash\n * @returns Hash string (base36 encoded)\n * @internal\n */\nexport function hashString(str: string): string {\n  // FNV-1a hash - better distribution than djb2\n  let hash = 2166136261; // FNV offset basis\n  for (let i = 0; i < str.length; i++) {\n    hash ^= str.charCodeAt(i);\n    // FNV prime multiplication (using bit operations for performance)\n    hash = (hash * 16777619) >>> 0;\n  }\n  return hash.toString(36);\n}\n\n/**\n * Configuration for the in-memory cache.\n */\nexport interface MemoryCacheConfig {\n  /** Maximum number of entries to store (default: 100) */\n  maxEntries?: number;\n  /** Logger for cache operations */\n  logger?: Logger;\n}\n\n/**\n * In-memory cache implementation that respects Cache-Control headers.\n *\n * This is the default cache used by the SDK. It stores entries in memory\n * and automatically evicts the oldest entries when the limit is reached.\n *\n * @example\n * ```typescript\n * const cache = new MemoryCache({ maxEntries: 50 });\n * const client = new Refyne.Builder()\n *   .apiKey(key)\n *   .cache(cache)\n *   .build();\n * ```\n */\nexport class MemoryCache implements Cache {\n  private readonly store = new Map<string, CacheEntry>();\n  private readonly maxEntries: number;\n  private readonly logger?: Logger;\n\n  constructor(config: MemoryCacheConfig = {}) {\n    this.maxEntries = config.maxEntries ?? 100;\n    this.logger = config.logger;\n  }\n\n  async get(key: string): Promise<CacheEntry | undefined> {\n    const entry = this.store.get(key);\n\n    if (!entry) {\n      return undefined;\n    }\n\n    const now = Date.now();\n\n    // Check if entry has expired\n    if (entry.expiresAt < now) {\n      // Check for stale-while-revalidate\n      if (entry.cacheControl.staleWhileRevalidate) {\n        const staleDeadline = entry.expiresAt + (entry.cacheControl.staleWhileRevalidate * 1000);\n        if (now < staleDeadline) {\n          this.logger?.debug('Serving stale cache entry', { key });\n          return entry;\n        }\n      }\n\n      // Entry is fully expired\n      this.store.delete(key);\n      this.logger?.debug('Cache entry expired', { key });\n      return undefined;\n    }\n\n    this.logger?.debug('Cache hit', { key });\n    return entry;\n  }\n\n  async set(key: string, entry: CacheEntry): Promise<void> {\n    // Don't cache if no-store\n    if (entry.cacheControl.noStore) {\n      this.logger?.debug('Not caching due to no-store', { key });\n      return;\n    }\n\n    // Evict oldest entries if at capacity\n    if (this.store.size >= this.maxEntries) {\n      const oldestKey = this.store.keys().next().value;\n      if (oldestKey) {\n        this.store.delete(oldestKey);\n        this.logger?.debug('Evicted oldest cache entry', { key: oldestKey });\n      }\n    }\n\n    this.store.set(key, entry);\n    this.logger?.debug('Cache set', { key, expiresAt: entry.expiresAt });\n  }\n\n  async delete(key: string): Promise<void> {\n    this.store.delete(key);\n    this.logger?.debug('Cache delete', { key });\n  }\n\n  /** Clear all cache entries */\n  clear(): void {\n    this.store.clear();\n    this.logger?.debug('Cache cleared');\n  }\n\n  /** Get the current number of cached entries */\n  get size(): number {\n    return this.store.size;\n  }\n}\n\n/**\n * Create a cache entry from a response.\n *\n * @param value - The response body to cache\n * @param cacheControlHeader - The Cache-Control header value\n * @returns Cache entry, or undefined if response should not be cached\n */\nexport function createCacheEntry(\n  value: unknown,\n  cacheControlHeader: string | null\n): CacheEntry | undefined {\n  const cacheControl = parseCacheControl(cacheControlHeader);\n\n  // Don't cache if no-store\n  if (cacheControl.noStore) {\n    return undefined;\n  }\n\n  // Calculate expiry\n  let expiresAt = Date.now();\n\n  if (cacheControl.maxAge !== undefined) {\n    expiresAt += cacheControl.maxAge * 1000;\n  } else {\n    // No max-age specified, don't cache\n    return undefined;\n  }\n\n  return {\n    value,\n    expiresAt,\n    cacheControl,\n  };\n}\n","/**\n * Error types for the Refyne SDK.\n *\n * All SDK errors extend {@link RefyneError} which provides consistent\n * error handling across the API.\n *\n * @packageDocumentation\n */\n\n/**\n * Base error class for all Refyne SDK errors.\n *\n * @example\n * ```typescript\n * try {\n *   await refyne.extract({ url, schema });\n * } catch (error) {\n *   if (error instanceof RefyneError) {\n *     console.error(`API Error: ${error.message} (status: ${error.status})`);\n *   }\n * }\n * ```\n */\nexport class RefyneError extends Error {\n  /** HTTP status code from the API response */\n  readonly status: number;\n  /** Additional error details from the API */\n  readonly detail?: string;\n  /** The original response (if available) */\n  readonly response?: Response;\n\n  constructor(\n    message: string,\n    status: number,\n    detail?: string,\n    response?: Response\n  ) {\n    super(message);\n    this.name = 'RefyneError';\n    this.status = status;\n    this.detail = detail;\n    this.response = response;\n\n    // Maintains proper stack trace for where error was thrown (V8 engines)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, RefyneError);\n    }\n  }\n}\n\n/**\n * Error thrown when the API rate limit is exceeded.\n *\n * The `retryAfter` property indicates how many seconds to wait\n * before retrying. The SDK's auto-retry handles this automatically.\n *\n * @example\n * ```typescript\n * try {\n *   await refyne.extract({ url, schema });\n * } catch (error) {\n *   if (error instanceof RateLimitError) {\n *     console.log(`Rate limited. Retry after ${error.retryAfter} seconds`);\n *   }\n * }\n * ```\n */\nexport class RateLimitError extends RefyneError {\n  /** Seconds to wait before retrying */\n  readonly retryAfter: number;\n\n  constructor(\n    message: string,\n    retryAfter: number,\n    detail?: string,\n    response?: Response\n  ) {\n    super(message, 429, detail, response);\n    this.name = 'RateLimitError';\n    this.retryAfter = retryAfter;\n  }\n}\n\n/**\n * Error thrown when request validation fails.\n *\n * This typically indicates an issue with the request payload,\n * such as an invalid URL or malformed schema.\n */\nexport class ValidationError extends RefyneError {\n  /** Field-level validation errors */\n  readonly errors?: Record<string, string[]>;\n\n  constructor(\n    message: string,\n    errors?: Record<string, string[]>,\n    response?: Response\n  ) {\n    super(message, 400, undefined, response);\n    this.name = 'ValidationError';\n    this.errors = errors;\n  }\n}\n\n/**\n * Error thrown when the API version is incompatible with the SDK.\n *\n * This occurs when the API version is lower than the SDK's minimum\n * supported version, or when the API major version is higher than\n * the SDK knows about.\n *\n * @example\n * ```typescript\n * try {\n *   await refyne.extract({ url, schema });\n * } catch (error) {\n *   if (error instanceof UnsupportedAPIVersionError) {\n *     console.error(`API version ${error.apiVersion} is not supported.`);\n *     console.error(`This SDK requires API version >= ${error.minVersion}`);\n *   }\n * }\n * ```\n */\nexport class UnsupportedAPIVersionError extends RefyneError {\n  /** The API version that was detected */\n  readonly apiVersion: string;\n  /** The minimum version this SDK supports */\n  readonly minVersion: string;\n  /** The maximum known version this SDK was built for */\n  readonly maxKnownVersion: string;\n\n  constructor(\n    apiVersion: string,\n    minVersion: string,\n    maxKnownVersion: string\n  ) {\n    const message = `API version ${apiVersion} is not supported. This SDK requires API version >= ${minVersion}. Please upgrade the API or use an older SDK version.`;\n    super(message, 0);\n    this.name = 'UnsupportedAPIVersionError';\n    this.apiVersion = apiVersion;\n    this.minVersion = minVersion;\n    this.maxKnownVersion = maxKnownVersion;\n  }\n}\n\n/**\n * Error thrown when TLS certificate validation fails.\n *\n * This error is thrown when connecting to an API endpoint with\n * an invalid, self-signed, or expired certificate.\n */\nexport class TLSError extends RefyneError {\n  /** The URL that failed TLS validation */\n  readonly url: string;\n  /** The underlying TLS error message */\n  readonly tlsError: string;\n\n  constructor(url: string, tlsError: string) {\n    super(`TLS certificate validation failed for ${url}: ${tlsError}`, 0);\n    this.name = 'TLSError';\n    this.url = url;\n    this.tlsError = tlsError;\n  }\n}\n\n/**\n * Error thrown when a request times out.\n */\nexport class TimeoutError extends RefyneError {\n  /** The timeout duration in milliseconds */\n  readonly timeoutMs: number;\n  /** The URL that timed out */\n  readonly url: string;\n\n  constructor(url: string, timeoutMs: number) {\n    super(`Request timed out after ${timeoutMs}ms: ${url}`, 0);\n    this.name = 'TimeoutError';\n    this.url = url;\n    this.timeoutMs = timeoutMs;\n  }\n}\n\n/**\n * Error thrown when a network error occurs (not a timeout).\n */\nexport class NetworkError extends RefyneError {\n  /** The underlying network error message */\n  readonly networkError: string;\n\n  constructor(message: string, networkError: string) {\n    super(message, 0);\n    this.name = 'NetworkError';\n    this.networkError = networkError;\n  }\n}\n\n/**\n * Error thrown when authentication fails.\n *\n * This typically indicates an invalid or expired API key.\n */\nexport class AuthenticationError extends RefyneError {\n  constructor(message: string = 'Authentication failed', response?: Response) {\n    super(message, 401, undefined, response);\n    this.name = 'AuthenticationError';\n  }\n}\n\n/**\n * Error thrown when the user lacks permission for an operation.\n *\n * This may indicate the user's tier doesn't have access to a feature,\n * or they've exceeded their quota.\n */\nexport class ForbiddenError extends RefyneError {\n  constructor(message: string = 'Access forbidden', response?: Response) {\n    super(message, 403, undefined, response);\n    this.name = 'ForbiddenError';\n  }\n}\n\n/**\n * Error thrown when a requested resource is not found.\n */\nexport class NotFoundError extends RefyneError {\n  constructor(\n    message: string = 'Resource not found',\n    response?: Response\n  ) {\n    super(message, 404, undefined, response);\n    this.name = 'NotFoundError';\n  }\n}\n\n/**\n * Create the appropriate error type from an API response.\n * @internal\n */\nexport async function createErrorFromResponse(\n  response: Response\n): Promise<RefyneError> {\n  let errorBody: { error?: string; message?: string; detail?: string; errors?: Record<string, string[]> } = {};\n\n  try {\n    errorBody = await response.json();\n  } catch {\n    // Response may not be JSON\n  }\n\n  const message = errorBody.error || errorBody.message || response.statusText || 'Unknown error';\n  const detail = errorBody.detail;\n\n  switch (response.status) {\n    case 400:\n      return new ValidationError(message, errorBody.errors, response);\n\n    case 401:\n      return new AuthenticationError(message, response);\n\n    case 403:\n      return new ForbiddenError(message, response);\n\n    case 404:\n      return new NotFoundError(message, response);\n\n    case 429: {\n      const retryAfter = parseInt(response.headers.get('Retry-After') || '60', 10);\n      return new RateLimitError(message, retryAfter, detail, response);\n    }\n\n    default:\n      return new RefyneError(message, response.status, detail, response);\n  }\n}\n","/**\n * SDK version information and API compatibility checking.\n *\n * @packageDocumentation\n */\n\nimport type { Logger } from './interfaces';\nimport { UnsupportedAPIVersionError } from './errors';\n\n/** Current SDK version */\nexport const SDK_VERSION = '0.0.0';\n\n/** Minimum API version this SDK supports */\nexport const MIN_API_VERSION = '0.0.0';\n\n/** Maximum API version this SDK was built against */\nexport const MAX_KNOWN_API_VERSION = '0.0.0';\n\n/**\n * Parse a semver version string into components.\n * @param version - Version string (e.g., \"1.2.3\" or \"1.2.3-beta\")\n * @returns Object with major, minor, patch numbers\n */\nexport function parseVersion(version: string): {\n  major: number;\n  minor: number;\n  patch: number;\n  prerelease?: string;\n} {\n  const match = version.match(/^(\\d+)\\.(\\d+)\\.(\\d+)(?:-(.+))?$/);\n  if (!match) {\n    return { major: 0, minor: 0, patch: 0 };\n  }\n\n  return {\n    major: parseInt(match[1], 10),\n    minor: parseInt(match[2], 10),\n    patch: parseInt(match[3], 10),\n    prerelease: match[4],\n  };\n}\n\n/**\n * Compare two semver versions.\n * @returns -1 if a < b, 0 if a == b, 1 if a > b\n */\nexport function compareVersions(a: string, b: string): -1 | 0 | 1 {\n  const va = parseVersion(a);\n  const vb = parseVersion(b);\n\n  if (va.major !== vb.major) {\n    return va.major < vb.major ? -1 : 1;\n  }\n  if (va.minor !== vb.minor) {\n    return va.minor < vb.minor ? -1 : 1;\n  }\n  if (va.patch !== vb.patch) {\n    return va.patch < vb.patch ? -1 : 1;\n  }\n\n  return 0;\n}\n\n/**\n * Check if an API version is compatible with this SDK.\n *\n * @param apiVersion - The API version from the X-API-Version header\n * @param logger - Logger for warnings\n * @throws {UnsupportedAPIVersionError} If the API version is too old\n */\nexport function checkAPIVersionCompatibility(\n  apiVersion: string,\n  logger: Logger\n): void {\n  // If API version is lower than minimum supported, throw error\n  if (compareVersions(apiVersion, MIN_API_VERSION) < 0) {\n    throw new UnsupportedAPIVersionError(\n      apiVersion,\n      MIN_API_VERSION,\n      MAX_KNOWN_API_VERSION\n    );\n  }\n\n  // If API major version is higher than known, warn about potential breaking changes\n  const apiParsed = parseVersion(apiVersion);\n  const maxParsed = parseVersion(MAX_KNOWN_API_VERSION);\n\n  if (apiParsed.major > maxParsed.major) {\n    logger.warn(\n      `API version ${apiVersion} is newer than this SDK was built for (${MAX_KNOWN_API_VERSION}). ` +\n        'There may be breaking changes. Consider upgrading the SDK.',\n      { apiVersion, sdkVersion: SDK_VERSION, maxKnownVersion: MAX_KNOWN_API_VERSION }\n    );\n  }\n}\n\n/**\n * Detect the current runtime environment.\n * @returns Runtime name and version string\n */\nexport function detectRuntime(): { name: string; version: string } {\n  // Check for Bun\n  if (typeof globalThis !== 'undefined' && 'Bun' in globalThis) {\n    const bun = (globalThis as unknown as { Bun: { version: string } }).Bun;\n    return { name: 'Bun', version: bun.version };\n  }\n\n  // Check for Deno\n  if (typeof globalThis !== 'undefined' && 'Deno' in globalThis) {\n    const deno = (globalThis as unknown as { Deno: { version: { deno: string } } }).Deno;\n    return { name: 'Deno', version: deno.version.deno };\n  }\n\n  // Check for Node.js (use globalThis to avoid Deno type errors)\n  if ('process' in globalThis) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const proc = (globalThis as any).process;\n    if (proc?.versions?.node) {\n      return { name: 'Node', version: proc.versions.node };\n    }\n  }\n\n  // Browser or unknown\n  if (typeof navigator !== 'undefined') {\n    return { name: 'Browser', version: 'unknown' };\n  }\n\n  return { name: 'Unknown', version: 'unknown' };\n}\n\n/**\n * Build the User-Agent string for SDK requests.\n *\n * @param customSuffix - Optional suffix to append (e.g., \"MyApp/1.0\")\n * @returns User-Agent string\n *\n * @example\n * ```typescript\n * buildUserAgent()\n * // Returns: \"Refyne-SDK-TypeScript/0.1.0 (Node/20.10.0)\"\n *\n * buildUserAgent(\"MyApp/1.0\")\n * // Returns: \"Refyne-SDK-TypeScript/0.1.0 (Node/20.10.0) MyApp/1.0\"\n * ```\n */\nexport function buildUserAgent(customSuffix?: string): string {\n  const runtime = detectRuntime();\n  let userAgent = `Refyne-SDK-TypeScript/${SDK_VERSION} (${runtime.name}/${runtime.version})`;\n\n  if (customSuffix) {\n    userAgent += ` ${customSuffix}`;\n  }\n\n  return userAgent;\n}\n","/**\n * Custom fetch wrapper with retry, timeout, and caching support.\n *\n * @packageDocumentation\n */\n\nimport type { Cache, Logger } from './interfaces';\nimport { createCacheEntry, generateCacheKey } from './cache';\nimport { TimeoutError, NetworkError, RefyneError } from './errors';\n\n/**\n * Configuration for the fetch wrapper.\n */\nexport interface FetchConfig {\n  /** Request timeout in milliseconds */\n  timeout: number;\n  /** Maximum retry attempts */\n  maxRetries: number;\n  /** Cache implementation */\n  cache: Cache;\n  /** Whether caching is enabled */\n  cacheEnabled: boolean;\n  /** Logger for debugging */\n  logger: Logger;\n  /** API key hash for cache key generation */\n  apiKeyHash: string;\n}\n\n/**\n * Calculate exponential backoff with jitter.\n *\n * @param attempt - Current attempt number (1-based)\n * @param baseMs - Base delay in milliseconds (default: 1000)\n * @param maxMs - Maximum delay in milliseconds (default: 30000)\n * @returns Delay in milliseconds with jitter applied\n */\nexport function calculateBackoffWithJitter(\n  attempt: number,\n  baseMs = 1000,\n  maxMs = 30000\n): number {\n  // Exponential backoff: 2^(attempt-1) * baseMs\n  const exponentialDelay = Math.pow(2, attempt - 1) * baseMs;\n  // Cap at maximum\n  const cappedDelay = Math.min(exponentialDelay, maxMs);\n  // Add jitter: random value between 0% and 25% of the delay\n  const jitter = Math.random() * 0.25 * cappedDelay;\n  return Math.floor(cappedDelay + jitter);\n}\n\n/**\n * Sleep for a given duration.\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Check if an error is retryable.\n */\nfunction isRetryableError(error: unknown): boolean {\n  // Network errors are retryable\n  if (error instanceof TypeError) {\n    const message = error.message.toLowerCase();\n    return (\n      message.includes('network') ||\n      message.includes('failed to fetch') ||\n      message.includes('connection') ||\n      message.includes('econnreset') ||\n      message.includes('econnrefused')\n    );\n  }\n  // Don't retry timeout errors\n  if (error instanceof TimeoutError) {\n    return false;\n  }\n  return false;\n}\n\n/**\n * Create a fetch function with retry, timeout, and caching support.\n *\n * @param config - Fetch configuration\n * @returns Enhanced fetch function\n */\nexport function createFetchWithRetry(config: FetchConfig): typeof fetch {\n  const { timeout, maxRetries, cache, cacheEnabled, logger, apiKeyHash } = config;\n\n  return async function fetchWithRetry(\n    input: RequestInfo | URL,\n    init?: RequestInit\n  ): Promise<Response> {\n    const url = input instanceof Request ? input.url : input.toString();\n    const method = init?.method?.toUpperCase() || 'GET';\n\n    // Check cache for GET requests\n    if (cacheEnabled && method === 'GET') {\n      const cacheKey = generateCacheKey(method, url, apiKeyHash);\n      try {\n        const cached = await cache.get(cacheKey);\n        if (cached) {\n          logger.debug('Cache hit', { url, cacheKey });\n          // Return a synthetic response from cache\n          return new Response(JSON.stringify(cached.value), {\n            status: 200,\n            headers: {\n              'Content-Type': 'application/json',\n              'X-Cache': 'HIT',\n            },\n          });\n        }\n      } catch (err) {\n        logger.warn('Cache get error', { url, error: String(err) });\n      }\n    }\n\n    let lastError: Error | undefined;\n    let attempt = 0;\n\n    while (attempt <= maxRetries) {\n      attempt++;\n\n      try {\n        // Create AbortController for timeout\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n        try {\n          const response = await fetch(input, {\n            ...init,\n            signal: controller.signal,\n          });\n\n          clearTimeout(timeoutId);\n\n          // Handle rate limiting (429) - retry with Retry-After header\n          if (response.status === 429 && attempt <= maxRetries) {\n            const retryAfter = parseInt(\n              response.headers.get('Retry-After') || '1',\n              10\n            );\n            const delayMs = retryAfter * 1000;\n            logger.warn('Rate limited, retrying', {\n              url,\n              attempt,\n              retryAfterSeconds: retryAfter,\n            });\n            await sleep(delayMs);\n            continue;\n          }\n\n          // Handle server errors (5xx) - retry with exponential backoff\n          if (response.status >= 500 && attempt <= maxRetries) {\n            const delayMs = calculateBackoffWithJitter(attempt);\n            logger.warn('Server error, retrying', {\n              url,\n              attempt,\n              status: response.status,\n              delayMs,\n            });\n            await sleep(delayMs);\n            continue;\n          }\n\n          // Cache successful GET responses\n          if (cacheEnabled && method === 'GET' && response.ok) {\n            const cacheKey = generateCacheKey(method, url, apiKeyHash);\n            const cacheControlHeader = response.headers.get('Cache-Control');\n\n            // Clone the response so we can read it for caching\n            const clonedResponse = response.clone();\n\n            try {\n              const body = await clonedResponse.json();\n              const entry = createCacheEntry(body, cacheControlHeader);\n              if (entry) {\n                await cache.set(cacheKey, entry);\n                logger.debug('Cached response', { url, cacheKey });\n              }\n            } catch (err) {\n              logger.debug('Failed to cache response', {\n                url,\n                error: String(err),\n              });\n            }\n          }\n\n          return response;\n        } catch (error) {\n          clearTimeout(timeoutId);\n\n          // Handle abort (timeout)\n          if (\n            error instanceof Error &&\n            error.name === 'AbortError'\n          ) {\n            throw new TimeoutError(url, timeout);\n          }\n\n          throw error;\n        }\n      } catch (error) {\n        lastError = error instanceof Error ? error : new Error(String(error));\n\n        // Don't retry timeout errors\n        if (error instanceof TimeoutError) {\n          throw error;\n        }\n\n        // Check if this is a retryable network error\n        if (isRetryableError(error) && attempt <= maxRetries) {\n          const delayMs = calculateBackoffWithJitter(attempt);\n          logger.warn('Network error, retrying', {\n            url,\n            attempt,\n            error: lastError.message,\n            delayMs,\n          });\n          await sleep(delayMs);\n          continue;\n        }\n\n        // Not retryable or max retries exceeded\n        if (error instanceof TimeoutError || error instanceof RefyneError) {\n          throw error;\n        }\n\n        throw new NetworkError(\n          `Request failed after ${attempt} attempts: ${lastError.message}`,\n          lastError.message\n        );\n      }\n    }\n\n    // Should not reach here, but just in case\n    throw lastError || new Error('Request failed');\n  };\n}\n","/**\n * Main Refyne client implementation.\n *\n * @packageDocumentation\n */\n\nimport createClient, { type Middleware } from 'openapi-fetch';\nimport type { paths, components } from './types';\nimport type { Logger, Cache } from './interfaces';\nimport { defaultLogger } from './interfaces';\nimport { MemoryCache, hashString } from './cache';\nimport { createErrorFromResponse } from './errors';\nimport { buildUserAgent, checkAPIVersionCompatibility, SDK_VERSION, MIN_API_VERSION, MAX_KNOWN_API_VERSION } from './version';\nimport { createFetchWithRetry } from './fetch';\n\n// Re-export useful component types for consumers\nexport type ExtractRequest = components['schemas']['ExtractInputBody'];\nexport type ExtractResponse = components['schemas']['ExtractOutputBody'];\nexport type CrawlRequest = components['schemas']['CreateCrawlJobInputBody'];\nexport type CrawlJobResponse = components['schemas']['CrawlJobResponseBody'];\nexport type AnalyzeRequest = components['schemas']['AnalyzeInputBody'];\nexport type AnalyzeResponse = components['schemas']['AnalyzeResponseBody'];\nexport type JobResponse = components['schemas']['JobResponse'];\nexport type SchemaOutput = components['schemas']['SchemaOutput'];\nexport type SavedSiteOutput = components['schemas']['SavedSiteOutput'];\nexport type UsageResponse = components['schemas']['GetUsageOutputBody'];\n\n/**\n * Configuration options for the Refyne client.\n */\nexport interface RefyneConfig {\n  /** Your Refyne API key */\n  apiKey: string;\n  /** Base URL for the API (default: https://api.refyne.uk) */\n  baseUrl?: string;\n  /** Request timeout in milliseconds (default: 30000) */\n  timeout?: number;\n  /** Maximum retry attempts for failed requests (default: 3) */\n  maxRetries?: number;\n  /** Custom logger implementation */\n  logger?: Logger;\n  /** Custom cache implementation */\n  cache?: Cache;\n  /** Whether caching is enabled (default: true) */\n  cacheEnabled?: boolean;\n  /** Custom User-Agent suffix (e.g., \"MyApp/1.0\") */\n  userAgentSuffix?: string;\n  /** Referer header for API key validation (required for demo/partner keys) */\n  referer?: string;\n}\n\nexport const DEFAULT_BASE_URL = 'https://api.refyne.uk';\nexport const DEFAULT_TIMEOUT = 30000;\nexport const DEFAULT_MAX_RETRIES = 3;\n\n/**\n * Fluent builder for creating Refyne client instances.\n *\n * @example\n * ```typescript\n * const client = new RefyneBuilder()\n *   .apiKey(process.env.REFYNE_API_KEY!)\n *   .baseUrl('https://api.refyne.uk')\n *   .timeout(60000)\n *   .build();\n * ```\n */\nexport class RefyneBuilder {\n  private config: Partial<RefyneConfig> = {};\n\n  /** Set the API key (required) */\n  apiKey(key: string): this {\n    this.config.apiKey = key;\n    return this;\n  }\n\n  /** Set the base URL */\n  baseUrl(url: string): this {\n    this.config.baseUrl = url;\n    return this;\n  }\n\n  /** Set the request timeout in milliseconds */\n  timeout(ms: number): this {\n    this.config.timeout = ms;\n    return this;\n  }\n\n  /** Set the maximum retry attempts */\n  maxRetries(count: number): this {\n    this.config.maxRetries = count;\n    return this;\n  }\n\n  /** Set a custom logger */\n  logger(logger: Logger): this {\n    this.config.logger = logger;\n    return this;\n  }\n\n  /** Set a custom cache */\n  cache(cache: Cache): this {\n    this.config.cache = cache;\n    return this;\n  }\n\n  /** Enable or disable caching */\n  cacheEnabled(enabled: boolean): this {\n    this.config.cacheEnabled = enabled;\n    return this;\n  }\n\n  /** Set a custom User-Agent suffix */\n  userAgentSuffix(suffix: string): this {\n    this.config.userAgentSuffix = suffix;\n    return this;\n  }\n\n  /** Build the client instance */\n  build(): Refyne {\n    if (!this.config.apiKey) {\n      throw new Error('API key is required');\n    }\n    return new Refyne(this.config as RefyneConfig);\n  }\n}\n\n// =============================================================================\n// Sub-clients for organized API access\n// =============================================================================\n\n/**\n * Jobs sub-client for job-related operations.\n */\nexport class JobsClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List all jobs. */\n  async list(options?: { limit?: number; offset?: number }) {\n    const { data, error } = await this.client.GET('/api/v1/jobs', {\n      params: { query: options },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get a job by ID. */\n  async get(id: string): Promise<JobResponse> {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get job results. */\n  async getResults(id: string, options?: { merge?: boolean }) {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}/results', {\n      params: {\n        path: { id },\n        query: options,\n      },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Download job results as a file. */\n  async download(id: string) {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}/download', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get the crawl map for a job. */\n  async getCrawlMap(id: string) {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}/crawl-map', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get debug capture data for a job. */\n  async getDebugCapture(id: string) {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}/debug-capture', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get webhook deliveries for a job. */\n  async getWebhookDeliveries(id: string) {\n    const { data, error } = await this.client.GET('/api/v1/jobs/{id}/webhooks', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n/**\n * Schemas sub-client for schema management.\n */\nexport class SchemasClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List all schemas. */\n  async list() {\n    const { data, error } = await this.client.GET('/api/v1/schemas');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get a schema by ID. */\n  async get(id: string): Promise<SchemaOutput> {\n    const { data, error } = await this.client.GET('/api/v1/schemas/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Create a new schema. */\n  async create(input: components['schemas']['CreateSchemaInputBody']): Promise<SchemaOutput> {\n    const { data, error } = await this.client.POST('/api/v1/schemas', {\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Update a schema. */\n  async update(id: string, input: components['schemas']['UpdateSchemaInputBody']): Promise<SchemaOutput> {\n    const { data, error } = await this.client.PUT('/api/v1/schemas/{id}', {\n      params: { path: { id } },\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Delete a schema. */\n  async delete(id: string) {\n    const { data, error } = await this.client.DELETE('/api/v1/schemas/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n/**\n * Sites sub-client for saved site management.\n */\nexport class SitesClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List all saved sites. */\n  async list() {\n    const { data, error } = await this.client.GET('/api/v1/sites');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get a saved site by ID. */\n  async get(id: string): Promise<SavedSiteOutput> {\n    const { data, error } = await this.client.GET('/api/v1/sites/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Create a new saved site. */\n  async create(input: components['schemas']['CreateSavedSiteInputBody']): Promise<SavedSiteOutput> {\n    const { data, error } = await this.client.POST('/api/v1/sites', {\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Update a saved site. */\n  async update(id: string, input: components['schemas']['UpdateSavedSiteInputBody']): Promise<SavedSiteOutput> {\n    const { data, error } = await this.client.PUT('/api/v1/sites/{id}', {\n      params: { path: { id } },\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Delete a saved site. */\n  async delete(id: string) {\n    const { data, error } = await this.client.DELETE('/api/v1/sites/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n/**\n * Keys sub-client for API key management.\n */\nexport class KeysClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List all API keys. */\n  async list() {\n    const { data, error } = await this.client.GET('/api/v1/keys');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Create a new API key. */\n  async create(name: string) {\n    const { data, error } = await this.client.POST('/api/v1/keys', {\n      body: { name },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Revoke an API key. */\n  async revoke(id: string) {\n    const { data, error } = await this.client.DELETE('/api/v1/keys/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n/**\n * LLM sub-client for LLM configuration management.\n */\nexport class LLMClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List available LLM providers. */\n  async listProviders() {\n    const { data, error } = await this.client.GET('/api/v1/llm/providers');\n    if (error) throw error;\n    return data;\n  }\n\n  /** List available models for a provider. */\n  async listModels(provider: string) {\n    const { data, error } = await this.client.GET('/api/v1/llm/models/{provider}', {\n      params: { path: { provider } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** List user's LLM service keys. */\n  async listKeys() {\n    const { data, error } = await this.client.GET('/api/v1/llm/keys');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Upsert an LLM service key. */\n  async upsertKey(input: components['schemas']['UserServiceKeyInput']) {\n    const { data, error } = await this.client.PUT('/api/v1/llm/keys', {\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Delete an LLM service key. */\n  async deleteKey(id: string) {\n    const { data, error } = await this.client.DELETE('/api/v1/llm/keys/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get user's LLM fallback chain. */\n  async getChain() {\n    const { data, error } = await this.client.GET('/api/v1/llm/chain');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Set user's LLM fallback chain. */\n  async setChain(input: components['schemas']['SetUserFallbackChainInputBody']) {\n    const { data, error } = await this.client.PUT('/api/v1/llm/chain', {\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n/**\n * Webhooks sub-client for webhook management.\n */\nexport class WebhooksClient {\n  constructor(private readonly client: ReturnType<typeof createClient<paths>>) {}\n\n  /** List all webhooks. */\n  async list() {\n    const { data, error } = await this.client.GET('/api/v1/webhooks');\n    if (error) throw error;\n    return data;\n  }\n\n  /** Get a webhook by ID. */\n  async get(id: string) {\n    const { data, error } = await this.client.GET('/api/v1/webhooks/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Create a new webhook. */\n  async create(input: components['schemas']['WebhookInput']) {\n    const { data, error } = await this.client.POST('/api/v1/webhooks', {\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Update a webhook. */\n  async update(id: string, input: components['schemas']['WebhookInput']) {\n    const { data, error } = await this.client.PUT('/api/v1/webhooks/{id}', {\n      params: { path: { id } },\n      body: input,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** Delete a webhook. */\n  async delete(id: string) {\n    const { data, error } = await this.client.DELETE('/api/v1/webhooks/{id}', {\n      params: { path: { id } },\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /** List webhook deliveries. */\n  async listDeliveries(id: string, options?: { limit?: number; offset?: number }) {\n    const { data, error } = await this.client.GET('/api/v1/webhooks/{id}/deliveries', {\n      params: { path: { id }, query: options },\n    });\n    if (error) throw error;\n    return data;\n  }\n}\n\n// =============================================================================\n// Main Client\n// =============================================================================\n\n/**\n * Refyne API client.\n *\n * Provides type-safe access to the Refyne API.\n *\n * @example\n * ```typescript\n * const client = new Refyne({ apiKey: process.env.REFYNE_API_KEY! });\n *\n * // Extract data from a page\n * const result = await client.extract({\n *   url: 'https://example.com/product',\n *   schema: { name: { type: 'string' }, price: { type: 'number' } }\n * });\n *\n * // Use sub-clients for organized access\n * const jobs = await client.jobs.list();\n * const schemas = await client.schemas.list();\n * ```\n */\nexport class Refyne {\n  /** Static builder for fluent construction */\n  static Builder = RefyneBuilder;\n\n  private readonly httpClient: ReturnType<typeof createClient<paths>>;\n  private readonly config: Required<Omit<RefyneConfig, 'userAgentSuffix' | 'referer'>> & { userAgentSuffix?: string; referer?: string };\n  private readonly logger: Logger;\n  private apiVersionChecked = false;\n\n  /** Sub-client for job operations */\n  readonly jobs: JobsClient;\n  /** Sub-client for schema operations */\n  readonly schemas: SchemasClient;\n  /** Sub-client for site operations */\n  readonly sites: SitesClient;\n  /** Sub-client for API key operations */\n  readonly keys: KeysClient;\n  /** Sub-client for LLM configuration */\n  readonly llm: LLMClient;\n  /** Sub-client for webhook operations */\n  readonly webhooks: WebhooksClient;\n\n  constructor(config: RefyneConfig) {\n    this.config = {\n      apiKey: config.apiKey,\n      baseUrl: (config.baseUrl || DEFAULT_BASE_URL).replace(/\\/$/, ''),\n      timeout: config.timeout || DEFAULT_TIMEOUT,\n      maxRetries: config.maxRetries || DEFAULT_MAX_RETRIES,\n      logger: config.logger || defaultLogger,\n      cache: config.cache || new MemoryCache(),\n      cacheEnabled: config.cacheEnabled !== false,\n      userAgentSuffix: config.userAgentSuffix,\n      referer: config.referer,\n    };\n\n    this.logger = this.config.logger;\n\n    // Build headers - include Referer if provided (required for demo/partner keys)\n    const headers: Record<string, string> = {\n      'Authorization': `Bearer ${this.config.apiKey}`,\n      'User-Agent': buildUserAgent(this.config.userAgentSuffix),\n      'X-SDK-Version': SDK_VERSION,\n    };\n    if (this.config.referer) {\n      // Set both Referer and X-Referer headers\n      // X-Referer is a fallback for environments that strip Referer (e.g., Cloudflare Workers)\n      headers['Referer'] = this.config.referer;\n      headers['X-Referer'] = this.config.referer;\n    }\n\n    // Create custom fetch with retry, timeout, and caching support\n    const customFetch = createFetchWithRetry({\n      timeout: this.config.timeout,\n      maxRetries: this.config.maxRetries,\n      cache: this.config.cache,\n      cacheEnabled: this.config.cacheEnabled,\n      logger: this.config.logger,\n      apiKeyHash: hashString(this.config.apiKey),\n    });\n\n    // Create openapi-fetch client with custom fetch\n    this.httpClient = createClient<paths>({\n      baseUrl: this.config.baseUrl,\n      headers,\n      fetch: customFetch,\n    });\n\n    // Add middleware for error handling and API version checking\n    this.httpClient.use(this.createErrorMiddleware());\n\n    // Initialize sub-clients\n    this.jobs = new JobsClient(this.httpClient);\n    this.schemas = new SchemasClient(this.httpClient);\n    this.sites = new SitesClient(this.httpClient);\n    this.keys = new KeysClient(this.httpClient);\n    this.llm = new LLMClient(this.httpClient);\n    this.webhooks = new WebhooksClient(this.httpClient);\n  }\n\n  private createErrorMiddleware(): Middleware {\n    return {\n      onResponse: async ({ response }) => {\n        // Check API version on first successful response\n        if (!this.apiVersionChecked && response.ok) {\n          const apiVersion = response.headers.get('X-API-Version');\n          if (apiVersion) {\n            checkAPIVersionCompatibility(apiVersion, this.logger);\n          }\n          this.apiVersionChecked = true;\n        }\n\n        // Handle error responses\n        if (!response.ok) {\n          const error = await createErrorFromResponse(response);\n          throw error;\n        }\n\n        return response;\n      },\n    };\n  }\n\n  // =========================================================================\n  // Core Extraction Methods (top-level for convenience)\n  // =========================================================================\n\n  /**\n   * Extract structured data from a single web page.\n   */\n  async extract(request: ExtractRequest): Promise<ExtractResponse> {\n    const { data, error } = await this.httpClient.POST('/api/v1/extract', {\n      body: request,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * Start an asynchronous crawl job.\n   */\n  async crawl(request: CrawlRequest): Promise<CrawlJobResponse> {\n    const { data, error } = await this.httpClient.POST('/api/v1/crawl', {\n      body: request,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * Analyze a website to detect structure and suggest schemas.\n   */\n  async analyze(request: AnalyzeRequest): Promise<AnalyzeResponse> {\n    const { data, error } = await this.httpClient.POST('/api/v1/analyze', {\n      body: request,\n    });\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * Get usage statistics for the current billing period.\n   */\n  async getUsage(): Promise<UsageResponse> {\n    const { data, error } = await this.httpClient.GET('/api/v1/usage');\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * Check API health status.\n   */\n  async health() {\n    const { data, error } = await this.httpClient.GET('/api/v1/health');\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * List available content cleaners.\n   */\n  async listCleaners() {\n    const { data, error } = await this.httpClient.GET('/api/v1/cleaners');\n    if (error) throw error;\n    return data;\n  }\n\n  /**\n   * Get available pricing tiers and their limits.\n   */\n  async getPricingTiers() {\n    const { data, error } = await this.httpClient.GET('/api/v1/pricing/tiers');\n    if (error) throw error;\n    return data;\n  }\n\n  // =========================================================================\n  // Utility Methods\n  // =========================================================================\n\n  /**\n   * Get the raw openapi-fetch client for advanced usage.\n   */\n  get rawClient() {\n    return this.httpClient;\n  }\n\n  /**\n   * Get SDK version information.\n   */\n  get version() {\n    return {\n      sdk: SDK_VERSION,\n      minApi: MIN_API_VERSION,\n      maxKnownApi: MAX_KNOWN_API_VERSION,\n    };\n  }\n}\n\n// Default export\nexport default Refyne;\n"]}